# ç¤¾äº¤èŠå¤©åº”ç”¨ - åç«¯ API

åŸºäº Node.js + Express + TypeScript å¼€å‘çš„ç¤¾äº¤èŠå¤©åº”ç”¨åç«¯æœåŠ¡ã€‚

## æŠ€æœ¯æ ˆ

- **è¿è¡Œç¯å¢ƒ**: Node.js 18+
- **Web æ¡†æ¶**: Express.js
- **è¯­è¨€**: TypeScript
- **æ•°æ®åº“**:
  - PostgreSQL (ä¸šåŠ¡æ•°æ®)
  - MongoDB (æ¶ˆæ¯è®°å½•)
  - Redis (ç¼“å­˜/ä¼šè¯)
- **å®æ—¶é€šä¿¡**: Socket.IO
- **è®¤è¯**: JWT (Access Token + Refresh Token)
- **æ–‡ä»¶ä¸Šä¼ **: Multer
- **æ—¥å¿—**: Winston
- **æµ‹è¯•**: Jest + Supertest

## åŠŸèƒ½æ¨¡å—

- âœ… ç”¨æˆ·ç³»ç»Ÿ (æ³¨å†Œã€ç™»å½•ã€ä¸ªäººèµ„æ–™)
- âœ… å³æ—¶é€šè®¯ (å•èŠã€ç¾¤èŠã€å®æ—¶æ¶ˆæ¯)
- âœ… ç¤¾äº¤åŠ¨æ€ (å‘å¸ƒã€ç‚¹èµã€è¯„è®º)
- âœ… å¥½å‹ç³»ç»Ÿ (ç”³è¯·ã€ç®¡ç†ã€åˆ†ç»„)
- âœ… è¯é¢˜ç¤¾åŒº (è¯é¢˜ã€å…³æ³¨ã€è®¨è®º)
- âœ… é€šçŸ¥ç³»ç»Ÿ (æ¶ˆæ¯é€šçŸ¥ã€ç³»ç»Ÿé€šçŸ¥)
- âœ… æœç´¢åŠŸèƒ½ (å…¨å±€æœç´¢ã€ç”¨æˆ·æœç´¢)
- âœ… æ–‡ä»¶ä¸Šä¼  (å›¾ç‰‡ã€è§†é¢‘)

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- PostgreSQL >= 14
- MongoDB >= 6.0
- Redis >= 7.0

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å®é™…é…ç½®
```

### æ•°æ®åº“è¿ç§»

```bash
# è¿è¡Œè¿ç§»
npm run migrate:latest

# å¡«å……ç§å­æ•°æ®
npm run seed:run
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:3000`

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm run start:prod
```

## é¡¹ç›®ç»“æ„

```
social-chat-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/          # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ validators/      # æ•°æ®éªŒè¯
â”‚   â”œâ”€â”€ types/           # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ websocket/       # WebSocket å¤„ç†
â”‚   â”œâ”€â”€ app.ts           # Express åº”ç”¨é…ç½®
â”‚   â””â”€â”€ server.ts        # æœåŠ¡å™¨å…¥å£
â”œâ”€â”€ migrations/          # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ seeds/               # æ•°æ®åº“ç§å­æ–‡ä»¶
â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ uploads/             # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”œâ”€â”€ logs/                # æ—¥å¿—ç›®å½•
â””â”€â”€ dist/                # ç¼–è¯‘è¾“å‡ºç›®å½•
```

## API æ–‡æ¡£

å¯åŠ¨æœåŠ¡åè®¿é—® Swagger æ–‡æ¡£ï¼š
- å¼€å‘ç¯å¢ƒ: `http://localhost:3000/api-docs`
- JSON è§„èŒƒ: `http://localhost:3000/api-docs/swagger.json`

### âš ï¸ é‡è¦ï¼šAPI æ–‡æ¡£åŒæ­¥æ›´æ–°è§„åˆ™

**ä»»ä½•å¯¹ API çš„æ”¹åŠ¨ï¼ˆæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ï¼‰éƒ½å¿…é¡»åŒæ­¥æ›´æ–° Swagger æ–‡æ¡£ï¼**

è¯¦ç»†çš„å¼€å‘è§„èŒƒè¯·å‚è€ƒï¼š[CONTRIBUTING.md](./CONTRIBUTING.md)

## å¯ç”¨è„šæœ¬

```bash
npm run dev              # å¼€å‘æ¨¡å¼
npm run build            # æ„å»ºé¡¹ç›®
npm run start            # å¯åŠ¨ç”Ÿäº§æœåŠ¡
npm run test             # è¿è¡Œæµ‹è¯•
npm run test:coverage    # æµ‹è¯•è¦†ç›–ç‡
npm run lint             # ä»£ç æ£€æŸ¥
npm run lint:fix         # è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
npm run format           # æ ¼å¼åŒ–ä»£ç 
npm run migrate:latest   # è¿è¡Œæ•°æ®åº“è¿ç§»
npm run migrate:rollback # å›æ»šæ•°æ®åº“è¿ç§»
npm run seed:run         # è¿è¡Œç§å­æ•°æ®
```

## ç¯å¢ƒå˜é‡

æŸ¥çœ‹ `.env.example` æ–‡ä»¶äº†è§£æ‰€æœ‰å¯é…ç½®çš„ç¯å¢ƒå˜é‡ã€‚

## æ•°æ®åº“è®¾è®¡

è¯¦ç»†çš„æ•°æ®åº“è®¾è®¡æ–‡æ¡£è¯·å‚è€ƒï¼š
- [æ•°æ®åº“è¿ç§»æ–‡æ¡£](../docs/database-migrations.md)
- [åç«¯å¼€å‘æŒ‡å—](../docs/backend-development-guide.md)

## API æµ‹è¯•

è¯¦ç»†çš„ API æµ‹è¯•æ–‡æ¡£è¯·å‚è€ƒï¼š
- [API æµ‹è¯•é›†åˆ](../docs/api-testing-collection.md)

## éƒ¨ç½²

### Docker éƒ¨ç½²

è¯¦ç»†çš„ Docker éƒ¨ç½²æ–‡æ¡£è¯·å‚è€ƒï¼š[DOCKER.md](./DOCKER.md)

```bash
# ç”Ÿäº§ç¯å¢ƒ
docker-compose up -d

# å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.dev.yml up -d
```

### æ‰‹åŠ¨éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t social-chat-backend .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 --env-file .env social-chat-backend
```

## å¼€å‘è§„èŒƒ

### å¿…è¯»æ–‡æ¡£

åœ¨å¼€å§‹å¼€å‘å‰ï¼Œè¯·åŠ¡å¿…é˜…è¯»ä»¥ä¸‹æ–‡æ¡£ï¼š

ğŸ“– **[CONTRIBUTING.md](./CONTRIBUTING.md)** - å®Œæ•´çš„å¼€å‘è§„èŒƒæ–‡æ¡£

åŒ…å«ï¼š
- âš ï¸ **API æ–‡æ¡£åŒæ­¥æ›´æ–°è§„åˆ™**ï¼ˆé‡è¦ï¼ï¼‰
- ä»£ç æäº¤è§„èŒƒ
- æ•°æ®åº“å˜æ›´è§„èŒƒ
- æµ‹è¯•è§„èŒƒ
- ä»£ç å®¡æŸ¥æ¸…å•

### æ ¸å¿ƒè§„åˆ™

1. **API æ”¹åŠ¨å¿…é¡»åŒæ­¥æ›´æ–°æ–‡æ¡£**
   - ä»»ä½•æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ API æ¥å£
   - å¿…é¡»åŒæ—¶æ›´æ–° `src/config/swagger.ts`
   - åœ¨ Swagger UI ä¸­éªŒè¯æ­£ç¡®æ€§

2. **ä»£ç å¿…é¡»é€šè¿‡æµ‹è¯•**
   - æ–°åŠŸèƒ½å¿…é¡»ç¼–å†™æµ‹è¯•
   - æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
   - æäº¤å‰è¿è¡Œ `npm test`

3. **éµå¾ª Commit Message è§„èŒƒ**
   - ä½¿ç”¨çº¦å®šå¼æäº¤æ ¼å¼
   - ç¤ºä¾‹ï¼š`feat(user): æ·»åŠ ç”¨æˆ·éªŒè¯åŠŸèƒ½`

4. **æ•°æ®åº“å˜æ›´å¿…é¡»å¯å›æ»š**
   - è¿ç§»æ–‡ä»¶å¿…é¡»å®ç° `up` å’Œ `down` æ–¹æ³•
   - æµ‹è¯•ç¯å¢ƒéªŒè¯åå†åº”ç”¨åˆ°ç”Ÿäº§

## æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm run test:watch

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

æµ‹è¯•æ–‡æ¡£ï¼š[tests/README.md](./tests/README.md)

## æ–‡æ¡£ç´¢å¼•

- **[CONTRIBUTING.md](./CONTRIBUTING.md)** - å¼€å‘è§„èŒƒï¼ˆå¿…è¯»ï¼‰
- **[DOCKER.md](./DOCKER.md)** - Docker éƒ¨ç½²æŒ‡å—
- **[tests/README.md](./tests/README.md)** - æµ‹è¯•æ–‡æ¡£
- **API æ–‡æ¡£**: http://localhost:3000/api-docs

## è®¸å¯è¯

MIT License
